# Pasive Information Gathering

## [[Whois]]

```
whois megacorp.com
```

## [[Netcraft]]
https://searchdns.netcraft.com/

```
site contains *.marca.com
```
## [[Google Hacking]]
https://www.exploit-db.com/google-hacking-database
```
site:marca.com filetype:php
site:marca.com -filetype:html
site:marca.com filetype:xls OR filetype:doc  #pdf,ppt,xlsx,doc,docx,pptx,pdf,csv,rtf,asp,aspx,cfm
site:marca.com inurl:admin filetype:php
site:marca.com inurl:profiles # db, backup, email, users.mdb
site:marca.com filetype:sql "IDENTIFIED BY" -cvs" 
site:marca.com filetype:sql "DUMPING DATA FOR TABLE" -cvs" 
site:marca.com filetype:sql "mysql dump" -cvs" 
inurl:admin/login site:gov.ro
```

### Footholds
https://www.exploit-db.com/google-hacking-database?category=1
### Files Containing Usernames
https://www.exploit-db.com/google-hacking-database?category=2
### Sensitive Directories
https://www.exploit-db.com/google-hacking-database?category=3
### Web Server Detection
https://www.exploit-db.com/google-hacking-database?category=4
### Vulnerable Files
https://www.exploit-db.com/google-hacking-database?category=5
### Vulnerable Servers
https://www.exploit-db.com/google-hacking-database?category=6
### Error Messages
https://www.exploit-db.com/google-hacking-database?category=7
### Files Containing Juicy Info
https://www.exploit-db.com/google-hacking-database?category=8
### Files Containing Passwords
https://www.exploit-db.com/google-hacking-database?category=9
### Sensitive Online Shopping info
https://www.exploit-db.com/google-hacking-database?category=10
### Network or Vulnerability Data
https://www.exploit-db.com/google-hacking-database?category=11
### Pages Containing Login Portals
https://www.exploit-db.com/google-hacking-database?category=12
### Various Online Devices
https://www.exploit-db.com/google-hacking-database?category=13
### Advisories and Vulnerabilities
https://www.exploit-db.com/google-hacking-database?category=14

## [[Github]]
https://github.com/

### Gitleaks
```
gitleaks -v -r=https://github.com/slowkeep/sl0wk3p.github.io
```

## [[Shodan]]
https://www.shodan.io/

```
hostname:marca.com 
hostname:marca.com port:'22'
```

## [[SecurityHeaders]]
https://securityheaders.com/
https://www.ssllabs.com/ssltest/

## [[Pastebin]]
```
site:pastebin.com intext:marca.com
```

## [[Email Harvesting]]
https://github.com/laramies/theHarvester

```
theharvester -d marca.com -b google
```

## [[Social Search]]
https://www.social-searcher.com/

## [[Twofi]]
https://tools.kali.org/information-gathering/twofi

## [[Linkedin2username]]
https://github.com/initstring/linkedin2username

## [[Osint Framework]]
https://osintframework.com/

## [[Build With & Wappalyzer]]
https://builtwith.com/
https://chrome.google.com/webstore/detail/wappalyzer/gppongmhjkpfnbhagpmjfkannfbllamg?hl=es

## [[Hunter.io]]
https://hunter.io/

## [[Spyse]]
https://spyse.com/

## [[Crt.sh]]

https://crt.sh/



# [[nslookup and dig]]


In the previous task, we used the WHOIS protocol to get various information about the domain name we were looking up. In particular, we were able to get the DNS servers from the registrar.

Find the IP address of a domain name using `nslookup`, which stands for Name Server Look Up. You need to issue the command `nslookup DOMAIN_NAME`, for example, `nslookup tryhackme.com`. Or, more generally, you can use `nslookup OPTIONS DOMAIN_NAME SERVER`. These three main parameters are:

-   OPTIONS contains the query type as shown in the table below. For instance, you can use `A` for IPv4 addresses and `AAAA` for IPv6 addresses.
-   DOMAIN_NAME is the domain name you are looking up.
-   SERVER is the DNS server that you want to query. You can choose any local or public DNS server to query. Cloudflare offers `1.1.1.1` and `1.0.0.1`, Google offers `8.8.8.8` and `8.8.4.4`, and Quad9 offers `9.9.9.9` and `149.112.112.112`. There are many [more public DNS servers](https://duckduckgo.com/?q=public+dns) that you can choose from if you want alternatives to your ISP’s DNS servers.

Query type

Result

A

IPv4 Addresses

AAAA

IPv6 Addresses

CNAME

Canonical Name

MX

Mail Servers

SOA

Start of Authority

TXT

TXT Records

For instance, `nslookup -type=A tryhackme.com 1.1.1.1` (or `nslookup -type=a tryhackme.com 1.1.1.1` as it is case-insensitive) can be used to return all the IPv4 addresses used by tryhackme.com.

Terminal

           `user@TryHackMe$ nslookup -type=A tryhackme.com 1.1.1.1
Server:		1.1.1.1
Address:	1.1.1.1#53

Non-authoritative answer:
Name:	tryhackme.com
Address: 172.67.69.208
Name:	tryhackme.com
Address: 104.26.11.229
Name:	tryhackme.com
Address: 104.26.10.229` 
        

The A and AAAA records are used to return IPv4 and IPv6 addresses, respectively. This lookup is helpful to know from a penetration testing perspective. In the example above, we started with one domain name, and we obtained three IPv4 addresses. Each of these IP addresses can be further checked for insecurities, assuming they lie within the scope of the penetration test.

Let’s say you want to learn about the email servers and configurations for a particular domain. You can issue `nslookup -type=MX tryhackme.com`. Here is an example:

Terminal

           `user@TryHackMe$ nslookup -type=MX tryhackme.com
Server:		127.0.0.53
Address:	127.0.0.53#53

Non-authoritative answer:
tryhackme.com	mail exchanger = 5 alt1.aspmx.l.google.com.
tryhackme.com	mail exchanger = 1 aspmx.l.google.com.
tryhackme.com	mail exchanger = 10 alt4.aspmx.l.google.com.
tryhackme.com	mail exchanger = 10 alt3.aspmx.l.google.com.
tryhackme.com	mail exchanger = 5 alt2.aspmx.l.google.com.`
        

We can see that tryhackme.com’s current email configuration uses Google. Since MX is looking up the Mail Exchange servers, we notice that when a mail server tries to deliver email `@tryhackme.com`, it will try to connect to the `aspmx.l.google.com`, which has order 1. If it is busy or unavailable, the mail server will attempt to connect to the next in order mail exchange servers, `alt1.aspmx.l.google.com` or `alt2.aspmx.l.google.com`.

Google provides the listed mail servers; therefore, we should not expect the mail servers to be running a vulnerable server version. However, in other cases, we might find mail servers that are not adequately secured or patched.

Such pieces of information might prove valuable as you continue the passive reconnaissance of your target. You can repeat similar queries for other domain names and try different types, such as `-type=txt`. Who knows what kind of information you might discover along your way!

For more advanced DNS queries and additional functionality, you can use `dig`, the acronym for “Domain Information Groper,” if you are curious. Let’s use `dig` to look up the MX records and compare them to `nslookup`. We can use `dig DOMAIN_NAME`, but to specify the record type, we would use `dig DOMAIN_NAME TYPE`. Optionally, we can select the server we want to query using `dig @SERVER DOMAIN_NAME TYPE`.

-   SERVER is the DNS server that you want to query.
-   DOMAIN_NAME is the domain name you are looking up.
-   TYPE contains the DNS record type, as shown in the table provided earlier.

Terminal

           `user@TryHackMe$ dig tryhackme.com MX

; <<>> DiG 9.16.19-RH <<>> tryhackme.com MX
;; global options: +cmd
;; Got answer:
;; ->>HEADER<` 

A quick comparison between the output of `nslookup` and `dig` shows that `dig` returned more information, such as the TTL (Time To Live) by default. If you want to query a `1.1.1.1` DNS server, you can execute `dig @1.1.1.1 tryhackme.com MX`.

Using the AttackBox, open the terminal and use the `nslookup` or `dig` command to get the information you need to answer the following question.


# [[DNSDumpster]]

DNS lookup tools, such as nslookup and dig, cannot find subdomains on their own. The domain you are inspecting might include a different subdomain that can reveal much information about the target. For instance, if tryhackme.com has the subdomains wiki.tryhackme.com and webmail.tryhackme.com, you want to learn more about these two as they can hold a trove of information about your target. There is a possibility that one of these subdomains has been set up and is not updated regularly. Lack of proper regular updates usually leads to vulnerable services. But how can we know that such subdomains exist?

We can consider using multiple search engines to compile a list of publicly known subdomains. One search engine won’t be enough; moreover, we should expect to go through at least tens of results to find interesting data. After all, you are looking for subdomains that are not explicitly advertised, and hence it is not necessary to make it to the first page of search results. Another approach to discover such subdomains would be to rely on brute-forcing queries to find which subdomains have DNS records.

To avoid such a time-consuming search, one can use an online service that offers detailed answers to DNS queries, such as [DNSDumpster](https://dnsdumpster.com/). If we search DNSDumpster for `tryhackme.com`, we will discover the subdomain `blog.tryhackme.com`, which a typical DNS query cannot provide. In addition, DNSDumpster will return the collected DNS information in easy-to-read tables and a graph. DNSDumpster will also provide any collected information about listening servers.

We will search for `tryhackme.com` on DNSDumpster to give you a glimpse of the expected output. Among the results, we got a list of DNS servers for the domain we are looking up. DNSDumpster also resolved the domain names to IP addresses and even tried to geolocate them. We can also see the MX records; DNSDumpster resolved all five mail exchange servers to their respective IP addresses and provided more information about the owner and location. Finally, we can see TXT records. Practically a single query was enough to retrieve all this information.

 ![](https://tryhackme-images.s3.amazonaws.com/user-uploads/5f04259cf9bf5b57aed2c476/room-content/655c1ce6c3bb53e6252128b6da135ba9.png)

DNSDumpster will also represent the collected information graphically. DNSDumpster displayed the data from the table earlier as a graph. You can see the DNS and MX branching to their respective servers and also showing the IP addresses.

![](https://tryhackme-images.s3.amazonaws.com/user-uploads/5f04259cf9bf5b57aed2c476/room-content/844a43bc37547bbb13f94894605992d3.png)  

There is currently a beta feature that allows you to export the graph as well. You can manipulate the graph and move blocks around if needed.

![](https://tryhackme-images.s3.amazonaws.com/user-uploads/5f04259cf9bf5b57aed2c476/room-content/eb95e62815b6ace3c823fd0159884731.png)  

Use the web browser on the AttackBox, or your system, to answer the following question.
